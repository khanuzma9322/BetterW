<!DOCTYpe <!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]>      <html class="no-js"> <!--<![endif]-->
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="style.css">
        <link rel="stylesheet" href="https://pyscript.net/alpha/pyscript.css" />
        <link href="http://fonts.cdnfonts.com/css/revolution-2" rel="stylesheet">
        <!-- <script defer src="https://pyscript.net/alpha/pyscript.js">
            // await pyodide.loadPackage("requests");
        </script>
        <script>
            let pyodide;
            async function main() {
            pyodide = await loadPyodide();
            await pyodide.loadPackage("requests");
            // matplotlib is now available
            }
            main();
        </script> -->
<script>
  var data;

    fetch("https://weather.visualcrossing.com/VisualCrossingWebServices/rest/services/timeline/atlanta%20ga?unitGroup=us&key=ESVDJCXR83MMMX2MQFC7FUGE6&contentType=json", {
  "method": "GET",
  "headers": {
  }
  })
.then(response => {
  if (!response.ok) {
    throw response; //check the http response code and if isn't ok then throw the response as an error
  }
            
  return response.json(); //parse the result as JSON

}).then(response => {
  //response now contains parsed JSON ready for use
  processWeatherData(response);

}).catch((errorResponse) => {
  if (errorResponse.text) { //additional error information
    errorResponse.text().then( errorMessage => {
      //errorMessage now returns the response body which includes the full error message
    })
  } else {
    //no additional error information 
  } 
});
 
function processWeatherData(response) {
  
  var location=response.resolvedAddress;
  var days=response.days;
  console.log("Location: "+location);
  for (var i=0;i<days.length;i++) {
    console.log(days[i].datetime+": tempmax="+days[i].tempmax+", tempmin="+days[i].tempmin);
  }
  data = days;
}

console.log("here");
        </script>
    </head>

    <div>
        
    </div>

    <div style="margin: 0; display: inline-block;">
        <header>
            BETTER WEATHER
        </header>
        <div class="subheading">
          Your one stop platform to know how you should dress, what you should carry, and what to expect from the weather today!
          You can check the weather on any day you want 2 weeks from now!
        </div>
        <!--[if lt IE 7]>
            <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="#">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->
        <form id="myForm" action="/better_weather_code.py" method=get>
            Date (YYYY-MM-DD): <input type="text" name="date"><br>
            
            <input type="submit"  onclick="myFunction(); return false;"> 
        </form>
        <p id = "dd"></p>
        <p id = "ee"></p>
        <p id = "demo"></p>
        <p id = "aa"></p>
        <p id = "bb"></p>
        <p id = "cc"></p>
        
        <body>
            <script>
                console.log("REACHED HERE");
                function myFunction() {
                  console.log("hi")
                  var x = document.getElementById("myForm").elements[0].value;
                  console.log(x)
                  // do api processing
                //   fetch("http://127.0.0.1:5000/e",
                //     {
                //       headers: {
                //         'Accept': 'application/json',
                //         'Content-Type': 'application/json'
                //     },
                //     method: "POST",
                //     body: JSON.stringify({a: 1, b: 2})
                // })
                // .then(function(res){ console.log(res) })
                // .catch(function(res){ console.log(res) })
                  
                  var call = "TODAY'S PREDICTIONS:"
                  document.getElementById("dd").innerHTML=call;
                  var call = "Temperature is 54 deg F"
                  document.getElementById("ee").innerHTML=call;
                  var call = "It's chilly, grab a sweater on your way out!"
                  document.getElementById("demo").innerHTML=call;
                  var call = "No rain predictions, no need for an umbrella."
                  document.getElementById("aa").innerHTML=call;
                  var call = "Beware of UV rays, wear sunscreen to protect your skin!"
                  document.getElementById("bb").innerHTML=call;
                  var call = "You're all set to deal with the weather today, have a great day :)"
                  document.getElementById("cc").innerHTML=call;
                  
                }

            </script>
            <!-- <py-script src="better_weather_code.py">
              
            </py-script> -->
        </body>
        <img src="cloud.png" alt="Cloud">
    </div>
</html>